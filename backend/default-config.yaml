server:
  host: 0.0.0.0
  port: 8000
  corsOrigin: "*"

logging:
  enabled: true
  backend:
    enabled: true
    clearOnStart: false
    fileName: backend.log
  frontend:
    enabled: true
    clearOnStart: false
    fileName: frontend.log

whisper:
  # Try base.en or small for a balance of speed and accuracy. Larger checkpoints
  # (large-v2, large-v3, large-v3-turbo) need a strong GPU but minimise errors.
  model: large-v3-turbo
  # Use a smaller checkpoint when the GPU is unavailable so CPU fallbacks stay
  # responsive. Set to null to reuse the primary model on CPU.
  cpuFallbackModel: base
  language: en
  sampleRate: 16000
  # Lower values (15-30) push words to the UI faster, higher values (45-120)
  # improve sentence structure.
  chunkLength: 20
  # Keep a few seconds lower than chunkLength so partial transmissions still
  # flush to the UI. When the radio is quiet the backend emits a chunk after
  # roughly minChunkDurationSeconds + silenceHoldSeconds seconds, so a lower
  # minimum keeps "blank" updates snappy.
  minChunkDurationSeconds: 12
  # Smaller overlaps (around 0.5s) keep latency down; raise toward 2-6s if
  # punctuation drifts.
  contextSeconds: 0.5
  # Raise when noisy rooms break chunks too early; lower for quiet dispatch
  # feeds.
  silenceThreshold: 0.02
  silenceLookbackSeconds: 2.0
  activeSamplesInLookbackPct: 0.10
  # Increase if trailing words are lost, decrease to shave latency.
  silenceHoldSeconds: 1.2
  # When the upstream HTTP audio stays effectively silent for this many
  # seconds, restart the connection to nudge stuck transports. Set to 0 or
  # null to disable automatic reconnects on silence. Streams that are quiet for
  # extended periods will reconnect roughly once per hour by default.
  silentStreamReconnectSeconds: 3600
  # If ffmpeg reads no PCM bytes at all for this long (transport/write stall),
  # restart the upstream regardless of audio energy. This is separate from
  # silence-based reconnects above and is safe to keep enabled.
  upstreamNoDataReconnectSeconds: 120
  maxConcurrentProcesses: 2
  # Decoder tweaks to keep phrases consistent across bursts.
  beamSize: 8
  decodeTemperature: 0.0
  temperatureIncrementOnFallback: 0.2
  conditionOnPreviousText: false
  # initialPrompt: >-
  #   This is part of an emergency radio conversation between firefighters and
  #   other emergency services in South Australia. Priority callouts include
  #   Adelaide, Adelaide fire out, Noarlunga, SITREP, SAPOL, and SES. Spell them
  #   exactly when they are heard on air.
  # prompts:
  #   sa_ses: >-
  #     This is part of an emergency radio conversation between firefighters and
  #     other emergency services in South Australia. Priority callouts include
  #     Adelaide, Adelaide fire out, Noarlunga, SITREP, SAPOL, and SES.
  # Front-end filtering keeps speech crisp and level.
  highpassCutoffHz: 250
  lowpassCutoffHz: 3800
  deemphasisTimeConstantMicros: 75
  agcTargetRms: 0.04
  silenceHallucinationPhrases:
    - "thank you"
    - "transcription by castingwords"
    - "casting words"
    - "all right here we go"
    - "alright here we go"
    - "all right let's go"
    - "alright let's go"
  # Automatically restart audio streams when upstream audio stays silent for
  # this long. Set to null to disable automatic reconnects for inactivity.
  noAudioReconnectSeconds: 3600
  # Treat segments that repeat the same phrase longer than this many characters
  # more than the allowed count as untranscribable noise.
  segmentRepetitionMinCharacters: 16
  segmentRepetitionMaxAllowedConsecutiveRepeats: 4

ui:
  themeMode: system
  colorCodingEnabled: false
  transcriptCorrectionEnabled: false
  reviewExportStatuses:
    - corrected
    - verified
  # Optional API key for richer Google Maps embeds in the UI. When unset,
  # the app uses a basic public embed. Generate a key with Maps Embed API
  # enabled and restrict it to your site origin.
  # googleMapsApiKey: ""
  # Optional base location used to disambiguate partial addresses when building
  # Google Maps links/embeds in the UI. If pager messages omit the state or
  # country, the frontend appends these values to the search query.
  # baseLocation:
  #   state: SA
  #   country: AU

streams:
  - id: broadcastify-2653
    name: SA SES Radio
    url: https://broadcastify.cdnstream1.com/2653
    enabled: true
    pinned: true
    ignoreFirstSeconds: 30
  - id: broadcastify-34010
    name: NSW - Primary Emergency Services
    url: https://broadcastify.cdnstream1.com/34010
    enabled: true
    ignoreFirstSeconds: 30
  - id: 4bb38cec-4662-4a3a-b83f-59685e81045d
    name: SA SES Pager Gateway
    source: pager
    webhookToken: replace-me

  # Example SDR stream for Marine VHF Channel 16 (156.800 MHz). Disabled by
  # default; enable after verifying the SDR plugin is available.
  - id: marine-ch16-sdr
    name: Marine VHF Ch 16 (SDR)
    source: sdr
    sdrDeviceId: rspdx
    sdrFrequencyHz: 156800000
    sdrMode: nfm
    sdrBandwidthHz: 15000
    sdrSquelchDbFs: -65
    enabled: false

# Local SDR devices for on-hardware capture (optional). Configure a SoapySDR
# device that can be used by streams with source: sdr. The SDRplay RSPdx is
# supported via the SoapySDRPlay3 module when installed on the host.
sdr:
  devices:
    - id: rspdx
      soapy: "driver=sdrplay"
      sampleRateHz: 240000   # 240 kS/s keeps CPU low and covers nearby channels
      # gainDb: 40           # Optional fixed gain; leave unset to use device defaults
      # gainMode: auto       # 'auto' enables device AGC when supported
      # rfBandwidthHz: 200000 # Hardware IF bandwidth; leave unset for driver default
      # antenna: "RX"        # Optional antenna selection
      # ppmCorrection: 0.0   # Optional frequency correction in parts-per-million
      # loOffsetHz: 250000   # Optional LO offset to dodge DC spike

combinedStreamViews:
  - id: aus-emergency-overview
    name: SA SES Radio+pager
    description: Adelaide SES radio and pager combined view
    streamIds:
      - broadcastify-2653
      - 4bb38cec-4662-4a3a-b83f-59685e81045d

alerts:
  enabled: true
  rules:
    - id: distress-mayday
      label: "Distress: MAYDAY"
      phrases:
        - mayday
      playSound: true
    - id: distress-pan-pan
      label: "Urgency: PAN-PAN"
      phrases:
        - pan-pan
        - pan pan
      playSound: true
    - id: distress-securite
      label: "Safety: SÉCURITÉ"
      phrases:
        - sécurité
        - securite
      playSound: true

access:
  defaultRole: read_only
  tokenTtlMinutes: 1440
  credentials:
    -
      password: change-me
      role: editor
