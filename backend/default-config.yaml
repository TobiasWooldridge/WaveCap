server:
  host: 0.0.0.0
  port: 8000
  corsOrigin: "*"

logging:
  enabled: true
  backend:
    enabled: true
    clearOnStart: false
    fileName: backend.log
  frontend:
    enabled: true
    clearOnStart: false
    fileName: frontend.log

whisper:
  # Try base.en or small for a balance of speed and accuracy. Larger checkpoints
  # (large-v2, large-v3, large-v3-turbo) need a strong GPU but minimise errors.
  model: large-v3-turbo
  # Use a smaller checkpoint when the GPU is unavailable so CPU fallbacks stay
  # responsive. Set to null to reuse the primary model on CPU.
  cpuFallbackModel: base
  language: en
  sampleRate: 16000
  # Lower values (15-30) push words to the UI faster, higher values (45-120)
  # improve sentence structure.
  chunkLength: 20
  # Keep a few seconds lower than chunkLength so partial transmissions still
  # flush to the UI. When the radio is quiet the backend emits a chunk after
  # roughly minChunkDurationSeconds + silenceHoldSeconds seconds, so a lower
  # minimum keeps "blank" updates snappy.
  minChunkDurationSeconds: 12
  # Smaller overlaps (around 0.5s) keep latency down; raise toward 2-6s if
  # punctuation drifts.
  contextSeconds: 0.5
  # Raise when noisy rooms break chunks too early; lower for quiet dispatch
  # feeds.
  silenceThreshold: 0.02
  silenceLookbackSeconds: 2.0
  activeSamplesInLookbackPct: 0.10
  # Increase if trailing words are lost, decrease to shave latency.
  silenceHoldSeconds: 1.2
  # When the upstream HTTP audio stays effectively silent for this many
  # seconds, restart the connection to nudge stuck transports. Set to 0 or
  # null to disable automatic reconnects on silence. Streams that are quiet for
  # extended periods will reconnect roughly once per hour by default.
  silentStreamReconnectSeconds: 3600
  # If ffmpeg reads no PCM bytes at all for this long (transport/write stall),
  # restart the upstream regardless of audio energy. This is separate from
  # silence-based reconnects above and is safe to keep enabled.
  upstreamNoDataReconnectSeconds: 120
  maxConcurrentProcesses: 2
  # Decoder tweaks to keep phrases consistent across bursts.
  beamSize: 8
  decodeTemperature: 0.0
  temperatureIncrementOnFallback: 0.2
  conditionOnPreviousText: false
  # initialPrompt: >-
  #   This is part of an emergency radio conversation between firefighters and
  #   other emergency services in South Australia. Priority callouts include
  #   Adelaide, Adelaide fire out, Noarlunga, SITREP, SAPOL, and SES. Spell them
  #   exactly when they are heard on air.
  # prompts:
  #   sa_ses: >-
  #     This is part of an emergency radio conversation between firefighters and
  #     other emergency services in South Australia. Priority callouts include
  #     Adelaide, Adelaide fire out, Noarlunga, SITREP, SAPOL, and SES.
  # Front-end filtering keeps speech crisp and level.
  highpassCutoffHz: 250
  lowpassCutoffHz: 3800
  deemphasisTimeConstantMicros: 75
  agcTargetRms: 0.04
  silenceHallucinationPhrases:
    - "thank you"
    - "transcription by castingwords"
    - "casting words"
    - "all right here we go"
    - "alright here we go"
    - "all right let's go"
    - "alright let's go"
  # Automatically restart audio streams when upstream audio stays silent for
  # this long. Set to null to disable automatic reconnects for inactivity.
  noAudioReconnectSeconds: 3600
  # Treat segments that repeat the same phrase longer than this many characters
  # more than the allowed count as untranscribable noise.
  segmentRepetitionMinCharacters: 16
  segmentRepetitionMaxAllowedConsecutiveRepeats: 4

ui:
  themeMode: system
  colorCodingEnabled: false
  transcriptCorrectionEnabled: false
  reviewExportStatuses:
    - corrected
    - verified
  # Optional API key for richer Google Maps embeds in the UI. When unset,
  # the app uses a basic public embed. Generate a key with Maps Embed API
  # enabled and restrict it to your site origin.
  # googleMapsApiKey: ""
  # Optional base location used to disambiguate partial addresses when building
  # Google Maps links/embeds in the UI. If pager messages omit the state or
  # country, the frontend appends these values to the search query.
  # baseLocation:
  #   state: SA
  #   country: AU

streams:
  - id: broadcastify-2653
    name: SA SES Radio
    url: https://broadcastify.cdnstream1.com/2653
    enabled: true
    pinned: true
    ignoreFirstSeconds: 30
  - id: broadcastify-34010
    name: NSW - Primary Emergency Services
    url: https://broadcastify.cdnstream1.com/34010
    enabled: true
    ignoreFirstSeconds: 30
  - id: 4bb38cec-4662-4a3a-b83f-59685e81045d
    name: SA SES Pager Gateway
    source: pager
    webhookToken: replace-me

  # Example remote radio stream powered by WaveCap‑SDR. Replace host/ids with
  # your WaveCap‑SDR channel endpoint(s). Multiple upstreams can be provided
  # for redundancy; the highest priority active source is used.
  - id: marine-ch16-remote
    name: Marine VHF Ch 16 (Remote)
    source: remote
    enabled: false
    remoteUpstreams:
      - id: primary
        mode: pull
        url: http://127.0.0.1:8087/api/v1/stream/channels/ch1.pcm?format=pcm16
        # authToken: <optional bearer token for WaveCap‑SDR>
        sampleRate: 16000
        format: pcm16
        priority: 10
      - id: backup
        mode: pull
        url: http://127.0.0.1:8087/api/v1/stream/channels/ch2.pcm?format=pcm16
        sampleRate: 16000
        format: pcm16
        priority: 5

ingest:
  # When set, remote senders must provide X-Ingest-Password with this value.
  # This password is rotated automatically in state/config.yaml when missing.
  password: change-me

combinedStreamViews:
  - id: aus-emergency-overview
    name: SA SES Radio+pager
    description: Adelaide SES radio and pager combined view
    streamIds:
      - broadcastify-2653
      - 4bb38cec-4662-4a3a-b83f-59685e81045d

alerts:
  enabled: true
  rules:
    - id: distress-mayday
      label: "Distress: MAYDAY"
      phrases:
        - mayday
      playSound: true
    - id: distress-pan-pan
      label: "Urgency: PAN-PAN"
      phrases:
        - pan-pan
        - pan pan
      playSound: true
    - id: distress-securite
      label: "Safety: SÉCURITÉ"
      phrases:
        - sécurité
        - securite
      playSound: true

access:
  defaultRole: read_only
  tokenTtlMinutes: 1440
  credentials:
    -
      password: change-me
      role: editor
